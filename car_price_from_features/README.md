# Прогноз стоимости автомобиля

## Описание проекта
Заказчиком в данном проекте является сервис по продаже автомобилей с пробегом. Данный сервис разрабатывает приложение, чтобы привлечь новых клиентов. В нём можно будет узнать рыночную стоимость своего автомобиля. 
На основе csv-файла с историческими данными: технические характеристики, комплектации и цены автомобилей, разработана модель машинного обучения для расчета стоимости автомобиля по его признакам. Лучшая модель для расчета стоимости автомобиля по его признакам выбрана, исходя из критериев:
- качество предсказания;
- скорость предсказания;
- время обучения.

## Использованные инструменты и библиотеки
Python, pandas, sklearn, matplotlib, phik, Pipeline, LinearRegression, DecisionTreeRegressor, LightGBM.

## Вывод
В ходе данного проекта были изучены данные сервиса по продаже автомобилей с пробегом, который помогает узнать рыночную стоимость своего автомобиля.

В наличии имеются данные с техническими характеристиками, комплектациями и ценами автомобилей из объявлений, созданных в марте и апреле 2016 года.

Было построено 3 модели (LightGBM, LinearRegression, DecisionTreeRegressor) для расчета стоимости автомобиля по его признакам. Основными критериями, важными заказчику были:
- качество предсказания;
- время обучения модели;
- время предсказания модели.

Перед проведением анализа и моделирования была сделана <u>предобработка данных</u>, в ходе которой были выявлены следующие моменты и проведены следующие действия:
- Названия столбцов приведены к "змеиному" регистру.
- Пропуски в столбцах были заполнены значением 'unknown' или 'other', если такле значение уже присутствовало в данных.
- Значение 'rangerover' было заменено на 'range_rover'.
- Были удалены строки с ценой равной 0 и годом регистрации ранее 1910 и позже 2016
- Были удалены столбцы RegistrationMonth, NumberOfPictures, DateCrawled, DateCreated, LastSeen как не несущие полезной информации о целевом признаке.
- Были удалены строки-дубликаты
- Значения мощности равное нулю и больше 5000 л.с. были заменены на медианное значение, рассчитанное исходя из модели автомобиля.

На этапе <u>исследовательского анализа данных</u> было изучено:
- распределение и описательные статистики всех количественных признаков.
- построены круговые диаграммы для всех категориальных признаков для понимания распределения различных классов данных в датасете.

В ходе <u>корреляционного анализа данных</u> была расчитана матрица корреляции коэффициента Фи. Было выявлено, что наблюдается мультиколлинеарность между признаками 'brand' и 'model', поэтому в моделировании использовался только признак 'model', имеющий больший коэффициент корреляции с целевым признаком.

Далее на этапе <u>обучения моделей</u> предварительно все количественные признаки были перемасштабированы с помощью StandardScaler, а категориальные были закодированы с помощью OneHotEncoder. Затем было обучено 3 модели и, исходя из критериев важных заказчику, была выбрана модель DecisionTreeRegressor с параметрами max_depth=15, min_samples_leaf=5, min_samples_split=15. Ее метрика RMSE = 1936.9 евро, время работы 0.089 минут.
